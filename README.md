# PCA-ORA plotting function for plant RNA-Seq data

#### This function is written in R and can be used to visualize RNA-Seq data with their MapMan/Mercator annotation. 

The function was used to assess drought stress in blackcurrant leaf and root tissues (Ziegler et al., 2024; [DOI: 10.1093/hr/uhae313]) and to analyze molecular mechanisms of floral initiation in strawberry (Ziegler et al., 2025; [DOI: 10.1101/2025.01.20.633581]). 


#### The data will be plotted as an PCA with an overrepresentation analysis (ORA) based on the DEGs, which have a high impact in the separation along the PC axes.

Required R packages:

dplyr, stringr, RColorBrewer, ggplot2


#### Input data

##### Mercator Annotation (Mappingfile)
The reference transcriptome need to be processed with Mercator/Mapman (https://www.plabipd.de/mercator_main.html).
Remove column 5 here.

##### Expression values (Expressiontable)
Raw TPM or CPM table with the gene/transcript IDs as rownames.

#####  Treatment table
Specify the variables/ treatment of your experiment. Column order: Your variables

##### Genes/Transcripts
All DEGs as a dataframe/ vector with one column.

##### Expressiontable_mean
A table with the mean expression value (mean CPM or mean TPM) for the different variables (max. 12).

#####  Plot colours
Can be specified, but is otherwise created automatically. Column order: Bordercolour, Symbolcolour, Symbols.

#####  Top
Specify the number of genes, which should be included in the ORA. Number of TopGene included in the ORA list at the end, default value is 50, can be either Default= NULL, TOP= number x (x<=1000 otherwise error message)

#####  TPM
TPM table, which will be used for the output boxplots.

#####  Name table
Specify the name for your output tables.

#####  Grouped table
Will be calculated by default.

#####  PCA scaling
TRUE= Rows will be scaled, FALSE= Columns will be scaled

#####  PCA score table
If the genes of the score table of the PCA are to be annotated for PC1-PC3 + an output file is to be given, is generated by default, ATTENTION: Extends the runtime by approx. 5 min with ~ 70,000 genes. Default: NULL ( 1 or NULL = an output is generated, 2= no output is generated)

#####  ORA filtering

TRUE/FALSE if ORA table should be filtered. Default: FALSE


**Citation:** If you use this code, please cite the this directory.


